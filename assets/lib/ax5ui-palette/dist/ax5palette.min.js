"use strict";!function(){var e=ax5.ui,t=ax5.util,o=void 0;e.addClass({className:"palette"},function(){return function(){var l=this,a=this,n=void 0;this.instanceId=ax5.getGuid(),this.target=null,this.config={clickEventName:"click",theme:"default",animateTime:100,colors:{preview:{width:24,height:24,cellWidth:30},label:{width:80},slider:{trackHeight:8,amount:32,handleWidth:18,handleHeight:18},list:[{label:"red",value:"#ff0000"},{label:"orange",value:"#ff9802"},{label:"yellow",value:"#ffff00"},{label:"green",value:"#00ff36"},{label:"blue",value:"#0000ff"},{label:"purple",value:"#ba00ff"},{label:"black",value:"#000000"},{label:"white",value:"#ffffff"}]},controls:{height:0},columnKeys:{}},this.xvar={},this.colors=[],n=this.config;var r={mousedown:ax5.info.supportTouch?"touchstart":"mousedown",mousemove:ax5.info.supportTouch?"touchmove":"mousemove",mouseup:ax5.info.supportTouch?"touchend":"mouseup"},i=function(e){var t=void 0,o=e.originalEvent?e.originalEvent:e;return t="changedTouches"in o&&o.changedTouches?o.changedTouches[0]:o,{clientX:t.pageX,clientY:t.pageY}},c=function(e){e.originalTrackWidth=e.$track.width(),e.trackWidth=e.originalTrackWidth-n.colors.slider.handleWidth/5;var o=f(e,e._amount);if(o<0||o>e.trackWidth){var l=void 0;o=o<0?0:o>e.trackWidth?e.trackWidth:o,l=h(e,o),d(e,s(e,l))}e.$handle.css({left:o}),e.$item.off(r.mousedown).on(r.mousedown,'[data-panel="color-handle"]',function(o){var l=i(o);e._originalHandleClientX=l.clientX,e._originalHandleLeft=e.$handle.position().left,p.on(e),t.stopEvent(o.originalEvent)}).off("click").on("click",'[data-panel="color-label"], [data-panel="color-preview"]',function(t){a.onClick&&a.onClick.call(e,"#"+e._selectedColor.toUpperCase(),t)}).on("click",'[data-panel="color-track"]',function(t){if("color-track"==t.target.getAttribute("data-panel")){var o=i(t),l=o.clientX-e.$track.offset().left,a=h(e,l);e.$handle.css({left:l}),d(e,s(e,a),t),o=null,l=null,a=null}})},d=function(e,t,o){e.$preview.css({"background-color":"#"+t}),e.$label.html("#"+t.toUpperCase()),e._selectedColor=t,o&&a.onUpdateColor&&a.onUpdateColor.call(e,"#"+e._selectedColor.toUpperCase())},s=function(e,t){var o={black:function(e,t){return e.lighten(n.colors.slider.amount/2).darken(t).getHexValue()},white:function(e,t){return e.darken(n.colors.slider.amount/2).darken(t).getHexValue()},normal:function(e,t){return e.darken(t).getHexValue()}};return e._uniqColor in o?o[e._uniqColor](e._color,t):o.normal(e._color,t)},u=function(e,t){var o={black:function(e,t){var o=e.lighten(n.colors.slider.amount/2);return 100*(o.getHsl().l-t.getHsl().l)},white:function(e,t){var o=e.darken(n.colors.slider.amount/2);return 100*(o.getHsl().l-t.getHsl().l)},normal:function(e,t){return 100*(e.getHsl().l-t.getHsl().l)}};return e._uniqColor in o?o[e._uniqColor](e._color,t):o.normal(e._color,t)},h=function(e,t){return n.colors.slider.amount*(t-e.trackWidth/2)/(e.originalTrackWidth/2)},f=function(e,t){return t*(e.originalTrackWidth/2)/n.colors.slider.amount+e.trackWidth/2},p={on:function(e){jQuery(document.body).on(r.mousemove+".ax5palette-"+l.instanceId,function(t){var o=i(t),l=o.clientX-e._originalHandleClientX,a=e._originalHandleLeft+l,n=void 0;a=a<0?0:a>e.trackWidth?e.trackWidth:a,e.$handle.css({left:a}),n=h(e,a),d(e,s(e,n),t),o=null,l=null}).on(r.mouseup+".ax5palette-"+l.instanceId,function(e){p.off(),t.stopEvent(e)}).on("mouseleave.ax5palette-"+l.instanceId,function(e){p.off(),t.stopEvent(e)}),jQuery(document.body).attr("unselectable","on").css("user-select","none").on("selectstart",!1)},off:function(){a.xvar.resizerLived=!1,jQuery(document.body).off(r.mousemove+".ax5palette-"+l.instanceId).off(r.mouseup+".ax5palette-"+l.instanceId).off("mouseleave.ax5palette-"+l.instanceId),jQuery(document.body).removeAttr("unselectable").css("user-select","auto").off("selectstart")}},v=function(e){({width:l.$target.innerWidth(),height:l.$target.innerHeight()});l.$target.html(o.tmpl.get("frame",{},n.columnKeys)),l.$={root:l.$target.find('[data-ax5palette-container="root"]'),colors:l.$target.find('[data-ax5palette-container="colors"]'),controls:l.$target.find('[data-ax5palette-container="controls"]')},n.colors.list.forEach(function(e){e._color=t.color(e.value),e._selectedColor=e._color.getHexValue(),0==e._color.r&&0==e._color.g&&0==e._color.b?(e._amount=n.colors.slider.amount,e._uniqColor="black",e._color0value="#"+e._color.lighten(n.colors.slider.amount).getHexValue(),e._color1value="#"+e._color.lighten(n.colors.slider.amount/2).getHexValue(),e._color2value="#"+e._color.getHexValue()):255==e._color.r&&255==e._color.g&&255==e._color.b?(e._amount=-n.colors.slider.amount,e._uniqColor="white",e._color0value="#"+e._color.getHexValue(),e._color1value="#"+e._color.darken(n.colors.slider.amount/2).getHexValue(),e._color2value="#"+e._color.darken(n.colors.slider.amount).getHexValue()):(e._amount=0,e._color0value="#"+e._color.lighten(n.colors.slider.amount).getHexValue(),e._color1value="#"+e._color.getHexValue(),e._color2value="#"+e._color.darken(n.colors.slider.amount).getHexValue())}),n.colors.slider.handleLeft=-n.colors.slider.handleWidth/2,n.colors.slider.handleTop=-n.colors.slider.handleHeight/2,l.$.colors.html(o.tmpl.get("colors",n,n.columnKeys)),l.$.colors.find("[data-ax5palette-color-index]").each(function(){var e=this.getAttribute("data-ax5palette-color-index"),t=n.colors.list[e],o=jQuery.extend({},t);o._index=e,o.$item=jQuery(this),o.$preview=o.$item.find('[data-panel="color"]'),o.$label=o.$item.find('[data-panel="color-label"]'),o.$track=o.$item.find('[data-panel="color-track"]'),o.$handle=o.$item.find('[data-panel="color-handle"]'),c(o),a.colors.push(o)}),e&&l.setSelectedColor(e)};this.init=function(){this.onStateChanged=n.onStateChanged,this.onClick=n.onClick,this.onUpdateColor=n.onUpdateColor,n.target||console.log(ax5.info.getError("ax5palette","401","setConfig")),this.$target=jQuery(n.target),setTimeout(function(){v((n.selectedColor||"").trim())})},this.repaint=function(){return v(),this},this.setSelectedColor=function(e){var o=t.color(e.trim()),l=765,n=-1;if(a.colors.forEach(function(e,t){var a=e._color.getHsl(),r=o.getHsl(),i=Math.abs(a.h-r.h)+Math.abs(a.s-r.s)+Math.abs(a.l-r.l);i<l&&(l=i,n=t)}),n>-1){var r=void 0,i=void 0,c=a.colors[n];c._amount=u(c,o),i=f(c,c._amount),c.$handle.css({left:i}),r=h(c,i),d(c,s(c,r))}return this},this.main=function(){e.palette_instance=e.palette_instance||[],e.palette_instance.push(this),arguments&&t.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)}}()),o=ax5.ui.palette}(),function(){var e=ax5.ui.palette,t=function(e){return'\n<div data-ax5palette-container="root">\n    <div data-ax5palette-container="colors"></div>\n    <div data-ax5palette-container="controls"></div>\n</div>\n'},o=function(e){return'\n{{#colors}}\n{{#list}}\n<div data-ax5palette-color="{{label}}" data-ax5palette-color-index="{{@i}}">\n    <div data-panel="color-preview" style="padding:{{preview.cellPadding}}px;width:{{preview.cellWidth}}px;">\n        <div data-panel="color-box" style="width:{{preview.width}}px;height:{{preview.height}}px;"><div data-panel="color" style="background-color:{{value}};"></div></div>\n    </div>\n    <div data-panel="color-label" style="width:{{label.width}}px;">{{label}}</div>\n    <div data-panel="color-slider">\n        <div data-panel="color-track" style="height:{{slider.trackHeight}}px;background: linear-gradient(90deg, {{_color0value}}, {{_color1value}}, {{_color2value}}); ">\n            <div data-panel="color-handle">\n                <div data-panel="color-handle-after" style="width:{{slider.handleWidth}}px;height:{{slider.handleWidth}}px;left:{{slider.handleLeft}}px;top:{{slider.handleLeft}}px;"></div>\n            </div>\n        </div>\n    </div>\n</div>\n{{/list}}\n{{/colors}}\n'};e.tmpl={frame:t,colors:o,get:function(t,o,l){return ax5.mustache.render(e.tmpl[t].call(this,l),o)}}}();
//# sourceMappingURL=ax5palette.min.js.map
